<html><body><p>WEEK-12</p><p>SPRING JPA WITH RELATIONAL DATABASE</p><p>Dependencies:  Spring web, Spring data jpa  and mysql drver</p><p>application.properties</p><p>spring.application.name=jpamysql</p><p>server.port=88</p><p></p><p># JDBC - change user/password/db name as needed</p><p>spring.datasource.url=jdbc:mysql://localhost:3306/employee_db?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC</p><p>spring.datasource.username=root</p><p>spring.datasource.password=</p><p>spring.datasource.driver-class-name=com.mysql.jdbc.Driver</p><p></p><p># JPA / Hibernate</p><p>spring.jpa.hibernate.ddl-auto=update</p><p>spring.jpa.show-sql=true</p><p></p><p>spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect</p><p></p><p>2.  Create database + sample data (run in MySQL)</p><p>CREATE DATABASE IF NOT EXISTS testdb;</p><p>USE employee_db;</p><p></p><p>CREATE TABLE IF NOT EXISTS employee (</p><p>  id INT PRIMARY KEY AUTO_INCREMENT,</p><p>  name VARCHAR(100),</p><p>  department VARCHAR(100)</p><p>);</p><p></p><p>INSERT INTO employee (name, department) VALUES</p><p>('Manogna','IT'),</p><p>('Keerthi','CSE'),</p><p>('Sai','ECE');</p><p></p><p>3) Entity — Employee.java</p><p>src/main/java/com/example/demo/Employee.java</p><p>package com.example.demo;</p><p></p><p>import jakarta.persistence.Entity;</p><p>import jakarta.persistence.GeneratedValue;</p><p>import jakarta.persistence.GenerationType;</p><p>import jakarta.persistence.Id;</p><p></p><p>@Entity</p><p>public class Employee {</p><p></p><p>    @Id</p><p>    @GeneratedValue(strategy = GenerationType.IDENTITY)</p><p>    private Integer id;</p><p></p><p>    private String name;</p><p>    private String department;</p><p></p><p>    public Employee() {}</p><p></p><p>    public Employee(String name, String department) {</p><p>        this.name = name;</p><p>        this.department = department;</p><p>    }</p><p></p><p>    // getters and setters — required for Jackson / JPA</p><p>    public Integer getId() { return id; }</p><p>    public void setId(Integer id) { this.id = id; }</p><p></p><p>    public String getName() { return name; }</p><p>    public void setName(String name) { this.name = name; }</p><p></p><p>    public String getDepartment() { return department; }</p><p>    public void setDepartment(String department) { this.department = department; }</p><p>}</p><p></p><p>4) Repository — EmployeeRepository.java</p><p>src/main/java/com/example/demo/EmployeeRepository.java</p><p>package com.example.demo;</p><p></p><p>import org.springframework.data.jpa.repository.JpaRepository;</p><p></p><p>public interface EmployeeRepository extends JpaRepository<Employee, Integer> { }</p><p></p><p>5) Controller — returns JSON and HTML view</p><p>src/main/java/com/example/demo/EmployeeController.java</p><p>package com.example.demo;</p><p></p><p>import org.springframework.beans.factory.annotation.Autowired;</p><p>import org.springframework.stereotype.Controller;</p><p>import org.springframework.ui.Model;</p><p>import org.springframework.web.bind.annotation.GetMapping;</p><p>import org.springframework.web.bind.annotation.RequestMapping;</p><p>import org.springframework.web.bind.annotation.RestController;</p><p></p><p>import java.util.List;</p><p></p><p>// REST endpoints</p><p>@RestController</p><p>@RequestMapping("/api")</p><p>class EmployeeRestController {</p><p>    @Autowired</p><p>    private EmployeeRepository repo;</p><p></p><p>    @GetMapping("/employees")</p><p>    public List<Employee> getAll() {</p><p>        return repo.findAll();</p><p>    }</p><p>}</p><p></p><p>// HTML (Thymeleaf) controller</p><p>@Controller</p><p>class EmployeeViewController {</p><p>    @Autowired</p><p>    private EmployeeRepository repo;</p><p></p><p>    @GetMapping("/employees")</p><p>    public String employeesPage(Model model) {</p><p>        model.addAttribute("employees", repo.findAll());</p><p>        return "employees";  // maps to src/main/resources/templates/employees.html</p><p>    }</p><p>}</p><p>Note: we used two controllers — one @RestController for JSON (/api/employees) and one @Controller for HTML (/employees). They can coexist.</p><p></p><p>6) Thymeleaf template — employees.html</p><p>Create file: src/main/resources/templates/employees.html</p><p><!DOCTYPE html></p><p><html xmlns:th="http://www.thymeleaf.org"></p><p><head></p><p>    <meta charset="UTF-8"/></p><p>    <title>Employees</title></p><p>    <style></p><p>      table { border-collapse: collapse; width: 70%; margin-top: 20px; }</p><p>      th, td { border: 1px solid #333; padding: 8px; text-align: left; }</p><p>      th { background: #efefef; }</p><p>    </style></p><p></head></p><p><body></p><p>  <h2>Employee List</h2></p><p>  <table></p><p>    <thead></p><p>      <tr><th>ID</th><th>Name</th><th>Department</th></tr></p><p>    </thead></p><p>    <tbody></p><p>      <tr th:each="e : ${employees}"></p><p>        <td th:text="${e.id}">1</td></p><p>        <td th:text="${e.name}">Name</td></p><p>        <td th:text="${e.department}">Dept</td></p><p>      </tr></p><p>    </tbody></p><p>  </table></p><p></body></p><p></html></p><p></p><p>7. pom.xml add these code</p><p><dependency></p><p>    <groupId>mysql</groupId></p><p>    <artifactId>mysql-connector-java</artifactId></p><p>    <version>5.1.49</version></p><p></dependency></p><p></p><p><dependency></p><p>    <groupId>org.springframework.boot</groupId></p><p>    <artifactId>spring-boot-starter-thymeleaf</artifactId></p><p></dependency></p><p></p><p></p><p>8) Run in STS</p><p>Import project into STS (File → Import → Existing Maven Projects).</p><p>Right-click project → Run As → Spring Boot App.</p><p>Visit:</p><p>HTML table: http://localhost:88/employees</p><p>JSON API: http://localhost:88/api/employees</p><p></p><p></p><p></p><p>2. Spring jpa with h2</p><p>Project name: h2db-jpa</p><p>Student.java:</p><p>package com.example.mysqldemo;</p><p></p><p></p><p>import jakarta.persistence.Entity;</p><p>import jakarta.persistence.GeneratedValue;</p><p>import jakarta.persistence.GenerationType;</p><p>import jakarta.persistence.Id;</p><p></p><p>@Entity</p><p>public class Student {</p><p></p><p>    @Id</p><p>    @GeneratedValue(strategy = GenerationType.IDENTITY)</p><p>    private Long id;</p><p></p><p>    private String name;</p><p>    private String city;</p><p></p><p>    public Student() {}</p><p></p><p>    public Student(String name, String city) {</p><p>        this.name = name;</p><p>        this.city = city;</p><p>    }</p><p></p><p>    public Long getId() {</p><p>        return id;</p><p>    }</p><p></p><p>    public void setId(Long id) {</p><p>        this.id = id;</p><p>    }</p><p></p><p>    public String getName() {</p><p>        return name;</p><p>    }</p><p></p><p>    public void setName(String name) {</p><p>        this.name = name;</p><p>    }</p><p></p><p>    public String getCity() {</p><p>        return city;</p><p>    }</p><p></p><p>    public void setCity(String city) {</p><p>        this.city = city;</p><p>    }</p><p>}</p><p></p><p>Student Controller.java:</p><p>package com.example.mysqldemo;</p><p></p><p>import org.springframework.beans.factory.annotation.Autowired;</p><p>import org.springframework.web.bind.annotation.*;</p><p></p><p>import java.util.List;</p><p></p><p>@RestController</p><p>public class StudentController {</p><p></p><p>    @Autowired</p><p>    private StudentRepository repo;</p><p></p><p>    @GetMapping("/")</p><p>    public String home() {</p><p>        return "Spring Boot + H2 + JPA Example Running!";</p><p>    }</p><p></p><p>    @GetMapping("/add")</p><p>    public String addStudent(@RequestParam String name,</p><p>                             @RequestParam String city) {</p><p>        repo.save(new Student(name, city));</p><p>        return "Student Added Successfully!";</p><p>    }</p><p></p><p>    @GetMapping("/students")</p><p>    public List<Student> getStudents() {</p><p>        return repo.findAll();</p><p>    }</p><p>}</p><p></p><p>Student Repository.java:</p><p>package com.example.mysqldemo;</p><p></p><p>import org.springframework.data.jpa.repository.JpaRepository;</p><p></p><p>public interface StudentRepository extends JpaRepository<Student, Long> {</p><p>}</p><p></p><p>Application.properties:</p><p>spring.application.name=h2db-jpa</p><p>spring.h2.console.enabled=true</p><p>spring.h2.console.path=/h2-console</p><p>spring.datasource.url=jdbc:h2:mem:testdb</p><p>spring.datasource.driverClassName=org.h2.Driver</p><p>spring.datasource.username=sa</p><p>spring.datasource.password=</p><p>spring.jpa.hibernate.ddl-auto=update</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><img src="image2.png" style="max-width:100%; margin-top:10px;"><img src="image1.png" style="max-width:100%; margin-top:10px;"><img src="image6.png" style="max-width:100%; margin-top:10px;"><img src="image5.png" style="max-width:100%; margin-top:10px;"><img src="image4.png" style="max-width:100%; margin-top:10px;"><img src="image3.png" style="max-width:100%; margin-top:10px;"></body></html>